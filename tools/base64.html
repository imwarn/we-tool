<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Base64 ç¼–è§£ç å·¥å…· - æ”¯æŒæ–‡æœ¬å’Œå›¾ç‰‡çš„ Base64 ç¼–ç è§£ç ">
    <meta name="keywords" content="base64,ç¼–ç ,è§£ç ,encode,decode,å›¾ç‰‡è½¬base64">
    <title>Base64 ç¼–è§£ç  - å¼€å‘è€…å·¥å…·ç®±</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ”</text></svg>">
    
    <!-- å…¬å…±æ ·å¼ -->
    <link rel="stylesheet" href="../assets/css/common.css">
    <link rel="stylesheet" href="../assets/css/tool.css">
    
    <style>
        .image-preview {
            max-width: 100%;
            max-height: 400px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
            border: 2px solid var(--color-secondary);
        }

        .image-preview.show {
            display: block;
        }

        .file-info {
            background: var(--color-secondary);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
        }

        .file-info.show {
            display: block;
        }

        .file-info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .file-info-label {
            font-weight: 600;
            color: var(--color-headline);
        }

        .file-info-value {
            color: var(--color-paragraph);
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="logo">
                <div class="logo-icon">ğŸ› ï¸</div>
                <span data-i18n="nav.home">å¼€å‘è€…å·¥å…·ç®±</span>
            </a>
            <a href="../index.html" class="back-btn">
                <span>â†</span>
                <span data-i18n="common.back">è¿”å›é¦–é¡µ</span>
            </a>
        </div>
    </nav>

    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
        <div class="page-header">
            <h1 class="page-title">ğŸ” Base64 ç¼–è§£ç </h1>
            <p class="page-subtitle">æ”¯æŒæ–‡æœ¬å’Œå›¾ç‰‡çš„ Base64 ç¼–ç è§£ç </p>
        </div>

        <!-- Tab åˆ‡æ¢ -->
        <div class="tool-panel">
            <div class="tabs">
                <button class="tab-btn active" onclick="DevToolkit.switchTab('text', event)">
                    ğŸ“ æ–‡æœ¬ç¼–è§£ç 
                </button>
                <button class="tab-btn" onclick="DevToolkit.switchTab('image', event)">
                    ğŸ–¼ï¸ å›¾ç‰‡ç¼–è§£ç 
                </button>
            </div>
        </div>

        <!-- Tab 1: æ–‡æœ¬ç¼–è§£ç  -->
        <div class="tab-content active" id="tab-text">
            <div class="tool-panel">
                <h2 class="section-title">æ–‡æœ¬ Base64 ç¼–è§£ç </h2>

                <div class="form-group">
                    <label class="form-label">è¾“å…¥æ–‡æœ¬</label>
                    <textarea 
                        class="form-textarea" 
                        id="textInput" 
                        placeholder="è¾“å…¥è¦ç¼–ç æˆ–è§£ç çš„æ–‡æœ¬..."
                        style="min-height: 200px;"
                    ></textarea>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="encodeText()">
                        <span>ğŸ”’</span>
                        <span>ç¼–ç ï¼ˆEncodeï¼‰</span>
                    </button>
                    <button class="btn btn-success" onclick="decodeText()">
                        <span>ğŸ”“</span>
                        <span>è§£ç ï¼ˆDecodeï¼‰</span>
                    </button>
                    <button class="btn btn-secondary" onclick="copyTextResult()">
                        <span>ğŸ“‹</span>
                        <span>å¤åˆ¶ç»“æœ</span>
                    </button>
                    <button class="btn btn-secondary" onclick="clearText()">
                        <span>ğŸ—‘ï¸</span>
                        <span>æ¸…ç©º</span>
                    </button>
                </div>

                <div class="form-group">
                    <label class="form-label">ç»“æœ</label>
                    <textarea 
                        class="form-textarea" 
                        id="textOutput" 
                        readonly
                        placeholder="ç¼–ç /è§£ç ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."
                        style="min-height: 200px;"
                    ></textarea>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="inputLength">0</div>
                            <div class="stat-label">è¾“å…¥é•¿åº¦</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="outputLength">0</div>
                            <div class="stat-label">è¾“å‡ºé•¿åº¦</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 2: å›¾ç‰‡ç¼–è§£ç  -->
        <div class="tab-content" id="tab-image">
            <!-- å›¾ç‰‡ç¼–ç  -->
            <div class="tool-panel">
                <h2 class="section-title">å›¾ç‰‡è½¬ Base64</h2>

                <div class="upload-area" id="imageUploadArea" onclick="document.getElementById('imageFileInput').click()">
                    <div class="upload-icon">ğŸ–¼ï¸</div>
                    <p style="font-size: 1.2em; margin-bottom: 10px; font-weight: 600;">ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ å›¾ç‰‡</p>
                    <p style="opacity: 0.7;">æ”¯æŒ PNGã€JPGã€GIFã€SVG ç­‰æ ¼å¼</p>
                </div>
                <input type="file" id="imageFileInput" accept="image/*" style="display: none;">

                <img id="imagePreview" class="image-preview" alt="å›¾ç‰‡é¢„è§ˆ">

                <div id="imageFileInfo" class="file-info">
                    <div class="file-info-item">
                        <span class="file-info-label">æ–‡ä»¶åï¼š</span>
                        <span class="file-info-value" id="fileName">-</span>
                    </div>
                    <div class="file-info-item">
                        <span class="file-info-label">æ–‡ä»¶å¤§å°ï¼š</span>
                        <span class="file-info-value" id="fileSize">-</span>
                    </div>
                    <div class="file-info-item">
                        <span class="file-info-label">å›¾ç‰‡å°ºå¯¸ï¼š</span>
                        <span class="file-info-value" id="imageDimensions">-</span>
                    </div>
                    <div class="file-info-item">
                        <span class="file-info-label">MIME ç±»å‹ï¼š</span>
                        <span class="file-info-value" id="mimeType">-</span>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="copyImageBase64()">
                        <span>ğŸ“‹</span>
                        <span>å¤åˆ¶ Base64</span>
                    </button>
                    <button class="btn btn-success" onclick="downloadImageBase64()">
                        <span>ğŸ’¾</span>
                        <span>ä¸‹è½½ä¸ºæ–‡æœ¬</span>
                    </button>
                </div>

                <div class="form-group">
                    <label class="form-label">Base64 ç»“æœ</label>
                    <textarea 
                        class="form-textarea" 
                        id="imageBase64Output" 
                        readonly
                        placeholder="Base64 ç¼–ç ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."
                        style="min-height: 150px;"
                    ></textarea>
                </div>
            </div>

            <!-- Base64 è§£ç ä¸ºå›¾ç‰‡ -->
            <div class="tool-panel">
                <h2 class="section-title">Base64 è½¬å›¾ç‰‡</h2>

                <div class="form-group">
                    <label class="form-label">è¾“å…¥ Base64 å­—ç¬¦ä¸²</label>
                    <textarea 
                        class="form-textarea" 
                        id="base64Input" 
                        placeholder="ç²˜è´´ Base64 å­—ç¬¦ä¸²ï¼ˆæ”¯æŒ data:image æ ¼å¼ï¼‰..."
                        style="min-height: 150px;"
                    ></textarea>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="decodeImageBase64()">
                        <span>ğŸ”„</span>
                        <span>è§£ç é¢„è§ˆ</span>
                    </button>
                    <button class="btn btn-success" onclick="downloadDecodedImage()">
                        <span>ğŸ’¾</span>
                        <span>ä¸‹è½½å›¾ç‰‡</span>
                    </button>
                </div>

                <div class="form-group">
                    <label class="form-label">é¢„è§ˆ</label>
                    <img id="decodedImagePreview" class="image-preview" alt="è§£ç åçš„å›¾ç‰‡">
                </div>
            </div>
        </div>

        <!-- ä½¿ç”¨è¯´æ˜ -->
        <div class="info-box">
            <h4>ğŸ’¡ ä½¿ç”¨è¯´æ˜</h4>
            <ul>
                <li><strong>æ–‡æœ¬ç¼–ç </strong>ï¼šå°†æ–‡æœ¬è½¬æ¢ä¸º Base64 ç¼–ç å­—ç¬¦ä¸²</li>
                <li><strong>æ–‡æœ¬è§£ç </strong>ï¼šå°† Base64 å­—ç¬¦ä¸²è¿˜åŸä¸ºåŸå§‹æ–‡æœ¬</li>
                <li><strong>å›¾ç‰‡ç¼–ç </strong>ï¼šå°†å›¾ç‰‡è½¬æ¢ä¸º Base64 Data URLï¼Œå¯ç›´æ¥åµŒå…¥ HTML/CSS</li>
                <li><strong>å›¾ç‰‡è§£ç </strong>ï¼šæ”¯æŒè§£æ Data URL å’Œçº¯ Base64 å­—ç¬¦ä¸²</li>
                <li><strong>å®‰å…¨æç¤º</strong>ï¼šBase64 ä¸æ˜¯åŠ å¯†ï¼Œä»…ç”¨äºç¼–ç ï¼Œä¸è¦ç”¨äºæ•æ„Ÿä¿¡æ¯ä¿æŠ¤</li>
            </ul>
        </div>
    </div>

    <!-- å…¬å…±è„šæœ¬ -->
    <script src="../assets/js/common.js"></script>

    <script>
        let currentImageBase64 = '';
        let currentImageFile = null;

        // ===== æ–‡æœ¬ç¼–è§£ç  =====
        document.getElementById('textInput').addEventListener('input', function() {
            document.getElementById('inputLength').textContent = this.value.length;
        });

        function encodeText() {
            const input = document.getElementById('textInput').value;
            if (!input) {
                DevToolkit.Toast.warning('è¯·è¾“å…¥è¦ç¼–ç çš„æ–‡æœ¬');
                return;
            }

            try {
                const encoded = btoa(unescape(encodeURIComponent(input)));
                document.getElementById('textOutput').value = encoded;
                document.getElementById('outputLength').textContent = encoded.length;
                DevToolkit.Toast.success('ç¼–ç æˆåŠŸï¼');
            } catch (e) {
                DevToolkit.Toast.error('ç¼–ç å¤±è´¥ï¼š' + e.message);
            }
        }

        function decodeText() {
            const input = document.getElementById('textInput').value;
            if (!input) {
                DevToolkit.Toast.warning('è¯·è¾“å…¥è¦è§£ç çš„ Base64 å­—ç¬¦ä¸²');
                return;
            }

            try {
                const decoded = decodeURIComponent(escape(atob(input.trim())));
                document.getElementById('textOutput').value = decoded;
                document.getElementById('outputLength').textContent = decoded.length;
                DevToolkit.Toast.success('è§£ç æˆåŠŸï¼');
            } catch (e) {
                DevToolkit.Toast.error('è§£ç å¤±è´¥ï¼šè¯·æ£€æŸ¥ Base64 æ ¼å¼æ˜¯å¦æ­£ç¡®');
            }
        }

        function copyTextResult() {
            const output = document.getElementById('textOutput').value;
            if (!output) {
                DevToolkit.Toast.warning('æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹');
                return;
            }
            DevToolkit.copyToClipboard(output);
        }

        function clearText() {
            document.getElementById('textInput').value = '';
            document.getElementById('textOutput').value = '';
            document.getElementById('inputLength').textContent = '0';
            document.getElementById('outputLength').textContent = '0';
        }

        // ===== å›¾ç‰‡ç¼–ç  =====
        const imageUploadArea = document.getElementById('imageUploadArea');
        const imageFileInput = document.getElementById('imageFileInput');

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            imageUploadArea.addEventListener(eventName, (e) => {
                e.preventDefault();
                e.stopPropagation();
            });
        });

        ['dragenter', 'dragover'].forEach(eventName => {
            imageUploadArea.addEventListener(eventName, () => {
                imageUploadArea.classList.add('dragover');
            });
        });

        ['dragleave', 'drop'].forEach(eventName => {
            imageUploadArea.addEventListener(eventName, () => {
                imageUploadArea.classList.remove('dragover');
            });
        });

        imageUploadArea.addEventListener('drop', (e) => {
            const files = e.dataTransfer.files;
            if (files.length > 0) handleImageFile(files[0]);
        });

        imageFileInput.addEventListener('change', (e) => {
            if (e.target.files[0]) handleImageFile(e.target.files[0]);
        });

        function handleImageFile(file) {
            if (!file.type.startsWith('image/')) {
                DevToolkit.Toast.error('è¯·ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶');
                return;
            }

            currentImageFile = file;
            const reader = new FileReader();

            reader.onload = function(e) {
                currentImageBase64 = e.target.result;
                
                // æ˜¾ç¤ºé¢„è§ˆ
                const preview = document.getElementById('imagePreview');
                preview.src = currentImageBase64;
                preview.classList.add('show');

                // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
                const img = new Image();
                img.onload = function() {
                    document.getElementById('fileName').textContent = file.name;
                    document.getElementById('fileSize').textContent = DevToolkit.formatFileSize(file.size);
                    document.getElementById('imageDimensions').textContent = `${img.width} Ã— ${img.height}`;
                    document.getElementById('mimeType').textContent = file.type;
                    document.getElementById('imageFileInfo').classList.add('show');
                };
                img.src = currentImageBase64;

                // æ˜¾ç¤º Base64
                document.getElementById('imageBase64Output').value = currentImageBase64;

                DevToolkit.Toast.success('å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼');
            };

            reader.readAsDataURL(file);
        }

        function copyImageBase64() {
            if (!currentImageBase64) {
                DevToolkit.Toast.warning('è¯·å…ˆä¸Šä¼ å›¾ç‰‡');
                return;
            }
            DevToolkit.copyToClipboard(currentImageBase64);
        }

        function downloadImageBase64() {
            if (!currentImageBase64) {
                DevToolkit.Toast.warning('è¯·å…ˆä¸Šä¼ å›¾ç‰‡');
                return;
            }
            DevToolkit.downloadFile(currentImageBase64, 'image-base64.txt', 'text/plain');
        }

        // ===== å›¾ç‰‡è§£ç  =====
        function decodeImageBase64() {
            let base64 = document.getElementById('base64Input').value.trim();
            
            if (!base64) {
                DevToolkit.Toast.warning('è¯·è¾“å…¥ Base64 å­—ç¬¦ä¸²');
                return;
            }

            // å¦‚æœä¸æ˜¯ data URLï¼Œå°è¯•æ·»åŠ å‰ç¼€
            if (!base64.startsWith('data:')) {
                base64 = 'data:image/png;base64,' + base64;
            }

            try {
                const preview = document.getElementById('decodedImagePreview');
                preview.src = base64;
                preview.classList.add('show');
                
                preview.onerror = () => {
                    DevToolkit.Toast.error('Base64 æ ¼å¼é”™è¯¯æˆ–ä¸æ˜¯æœ‰æ•ˆçš„å›¾ç‰‡');
                    preview.classList.remove('show');
                };

                preview.onload = () => {
                    DevToolkit.Toast.success('è§£ç æˆåŠŸï¼');
                };
            } catch (e) {
                DevToolkit.Toast.error('è§£ç å¤±è´¥ï¼š' + e.message);
            }
        }

        function downloadDecodedImage() {
            const preview = document.getElementById('decodedImagePreview');
            if (!preview.src || preview.src === window.location.href) {
                DevToolkit.Toast.warning('è¯·å…ˆè§£ç å›¾ç‰‡');
                return;
            }

            const link = document.createElement('a');
            link.href = preview.src;
            link.download = 'decoded-image.png';
            link.click();
            DevToolkit.Toast.success('å›¾ç‰‡å·²ä¸‹è½½ï¼');
        }
    </script>
</body>
</html>