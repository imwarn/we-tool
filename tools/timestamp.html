<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="æ—¶é—´æˆ³è½¬æ¢å·¥å…· - Unix æ—¶é—´æˆ³ã€ISO 8601ã€UTCã€æœ¬åœ°æ—¶é—´ç­‰å¤šç§æ ¼å¼äº’è½¬">
    <meta name="keywords" content="æ—¶é—´æˆ³è½¬æ¢,Unixæ—¶é—´æˆ³,timestamp,ISO8601,UTCæ—¶é—´">
    <title>æ—¶é—´æˆ³è½¬æ¢ - å¼€å‘è€…å·¥å…·ç®±</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>â°</text></svg>">
    
    <!-- å…¬å…±æ ·å¼ -->
    <link rel="stylesheet" href="../assets/css/common.css">
    <link rel="stylesheet" href="../assets/css/tool.css">
    
    <!-- Flatpickr CSS -->
    <link rel="stylesheet" href="../assets/css/flatpickr.min.css">
    
    <!-- æ—¶é—´æˆ³è½¬æ¢å·¥å…·æ ·å¼ -->
    <link rel="stylesheet" href="../assets/css/timestamp.css">
    <link rel="stylesheet" href="../assets/css/flatpickr-custom.css">

</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="../index.html" class="logo">
                <div class="logo-icon">ğŸ› ï¸</div>
                <span data-i18n="nav.home">å¼€å‘è€…å·¥å…·ç®±</span>
            </a>
            <a href="../index.html" class="back-btn">
                <span>â†</span>
                <span data-i18n="common.back">è¿”å›é¦–é¡µ</span>
            </a>
        </div>
    </nav>

    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
        <div class="page-header">
            <h1 class="page-title">â° æ—¶é—´æˆ³è½¬æ¢</h1>
            <p class="page-subtitle">Unix æ—¶é—´æˆ³ã€ISO 8601ã€UTCã€æœ¬åœ°æ—¶é—´ç­‰å¤šç§æ ¼å¼äº’è½¬</p>
        </div>

        <!-- å½“å‰æ—¶é—´ -->
        <div class="current-time">
            <div class="time-display" id="currentTimestamp">0</div>
            <div class="time-label">å½“å‰ Unix æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰</div>
            <div class="time-label" style="margin-top: 10px;" id="currentDateTime"></div>
        </div>

        <!-- æ—¶é—´æˆ³è½¬æ¢ -->
        <div class="tool-panel">
            <h2 class="section-title">æ—¶é—´æˆ³è½¬æ—¥æœŸ</h2>

            <div class="form-group">
                <label class="form-label">è¾“å…¥æ—¶é—´æˆ³</label>
                <input 
                    type="text" 
                    class="form-input" 
                    id="timestampInput"
                    placeholder="è¾“å…¥ Unix æ—¶é—´æˆ³ï¼ˆç§’æˆ–æ¯«ç§’ï¼‰"
                >
                <div class="quick-buttons">
                    <button class="quick-btn" onclick="useCurrentTimestamp()">ä½¿ç”¨å½“å‰æ—¶é—´</button>
                    <button class="quick-btn" onclick="useTimestamp(0)">Unix çºªå…ƒ (0)</button>
                    <button class="quick-btn" onclick="useTimestamp(946684800000)">2011-06-01</button>
                    <button class="quick-btn" onclick="useTimestamp(1577836800000)">2017-10-05</button>
                    <button class="quick-btn" onclick="useTimestamp(1609459200000)">2025-12-12</button>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">è½¬æ¢ç»“æœ</label>
                <div id="timestampResults"></div>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" onclick="convertTimestamp()">
                    <span>ğŸ”„</span>
                    <span>è½¬æ¢</span>
                </button>
            </div>
        </div>

        <!-- æ—¥æœŸè½¬æ—¶é—´æˆ³ -->
        <div class="tool-panel">
            <h2 class="section-title">æ—¥æœŸè½¬æ—¶é—´æˆ³</h2>

            <div class="date-time-container">
                <div class="datetime-grid">
                    <div class="form-group" style="margin-bottom: 0;">
                        <label class="form-label">é€‰æ‹©æ—¥æœŸ</label>
                        <div class="input-with-icon">
                            <span class="input-icon">ğŸ“…</span>
                            <input 
                                type="text" 
                                class="datetime-input"
                                id="dateInput"
                                placeholder="é€‰æ‹©æ—¥æœŸ"
                                readonly
                            >
                        </div>
                    </div>

                    <div class="form-group" style="margin-bottom: 0;">
                        <label class="form-label">é€‰æ‹©æ—¶é—´ï¼ˆæ—¶:åˆ†:ç§’ï¼‰</label>
                        <div class="input-with-icon">
                            <span class="input-icon">ğŸ•</span>
                            <input 
                                type="text" 
                                class="datetime-input"
                                id="timeInput"
                                placeholder="é€‰æ‹©æ—¶é—´ï¼ˆå«ç§’ï¼‰"
                                readonly
                            >
                        </div>
                    </div>
                </div>

                <div class="date-hint">
                    <span class="date-hint-icon">ğŸ’¡</span>
                    <span><strong>æç¤ºï¼š</strong>ç‚¹å‡»è¾“å…¥æ¡†å¯ä»¥ä½¿ç”¨ç¾åŒ–çš„æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨ï¼Œå®Œç¾é€‚é…ç«™ç‚¹ä¸»é¢˜ï¼Œæ—¶é—´ç²¾ç¡®åˆ°ç§’</span>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">è½¬æ¢ç»“æœ</label>
                <div id="dateResults"></div>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" onclick="convertDate()">
                    <span>ğŸ”„</span>
                    <span>è½¬æ¢</span>
                </button>
                <button class="btn btn-secondary" onclick="useTodayDate()">
                    <span>ğŸ“…</span>
                    <span>ä½¿ç”¨å½“å‰æ—¶é—´</span>
                </button>
                <button class="btn btn-secondary" onclick="useYesterdayDate()">
                    <span>â®ï¸</span>
                    <span>æ˜¨å¤© 00:00:00</span>
                </button>
                <button class="btn btn-secondary" onclick="useTomorrowDate()">
                    <span>â­ï¸</span>
                    <span>æ˜å¤© 00:00:00</span>
                </button>
                <button class="btn btn-secondary" onclick="resetDateTime()">
                    <span>ğŸ”„</span>
                    <span>é‡ç½®</span>
                </button>
            </div>
        </div>

        <!-- æ—¶åŒºè½¬æ¢ -->
        <div class="tool-panel">
            <h2 class="section-title">æ—¶åŒºä¿¡æ¯</h2>

            <div class="timezone-stats-grid">
                <div class="timezone-stat-item">
                    <div class="timezone-stat-value" id="localTimezone">-</div>
                    <div class="timezone-stat-label">æœ¬åœ°æ—¶åŒº</div>
                </div>
                <div class="timezone-stat-item">
                    <div class="timezone-stat-value" id="utcOffset">-</div>
                    <div class="timezone-stat-label">UTC åç§»</div>
                </div>
                <div class="timezone-stat-item">
                    <div class="timezone-stat-value" id="isDST">-</div>
                    <div class="timezone-stat-label">å¤ä»¤æ—¶</div>
                </div>
                <div class="timezone-stat-item">
                    <div class="timezone-stat-value" id="weekday">-</div>
                    <div class="timezone-stat-label">æ˜ŸæœŸå‡ </div>
                </div>
            </div>
        </div>

        <!-- ä½¿ç”¨è¯´æ˜ -->
        <div class="info-box">
            <h4>ğŸ’¡ ä½¿ç”¨è¯´æ˜</h4>
            <ul>
                <li><strong>Unix æ—¶é—´æˆ³</strong>ï¼šä» 1970-01-01 00:00:00 UTC å¼€å§‹çš„ç§’æ•°æˆ–æ¯«ç§’æ•°</li>
                <li><strong>è‡ªåŠ¨è¯†åˆ«</strong>ï¼šè‡ªåŠ¨è¯†åˆ«è¾“å…¥çš„æ˜¯ç§’ï¼ˆ10ä½ï¼‰è¿˜æ˜¯æ¯«ç§’ï¼ˆ13ä½ï¼‰</li>
                <li><strong>ç¾åŒ–é€‰æ‹©å™¨</strong>ï¼šä½¿ç”¨ Flatpickr å®ç°çš„ä¸»é¢˜ä¸€è‡´çš„æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨</li>
                <li><strong>ç§’çº§ç²¾åº¦</strong>ï¼šæ—¶é—´é€‰æ‹©å™¨æ”¯æŒç§’çº§ç²¾åº¦ï¼Œæ ¼å¼ä¸º HH:MM:SS</li>
                <li><strong>ç‚¹å‡»å¤åˆ¶</strong>ï¼šç‚¹å‡» ğŸ“‹ å›¾æ ‡å¿«é€Ÿå¤åˆ¶ç»“æœ</li>
                <li><strong>å¿«é€Ÿé€‰æ‹©</strong>ï¼šä½¿ç”¨å¿«æ·æŒ‰é’®å¿«é€Ÿé€‰æ‹©å¸¸ç”¨æ—¥æœŸ</li>
                <li><strong>è½»é‡çº§</strong>ï¼šFlatpickr ä»… ~6KB (gzipped)</li>
            </ul>
        </div>
    </div>

    <!-- Flatpickr JS -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/zh.js"></script>
    
    <!-- å…¬å…±è„šæœ¬ -->
    <script src="../assets/js/common.js"></script>

    <script>
        let datePicker, timePicker;

        // åˆå§‹åŒ–æ—¥æœŸé€‰æ‹©å™¨
        function initDatePickers() {
            // æ—¥æœŸé€‰æ‹©å™¨
            datePicker = flatpickr("#dateInput", {
                locale: "zh",
                dateFormat: "Y-m-d",
                defaultDate: new Date(),
                allowInput: false,
                clickOpens: true,
                animate: true,
                onChange: function(selectedDates, dateStr) {
                    convertDate();
                }
            });

            // æ—¶é—´é€‰æ‹©å™¨ï¼ˆæ”¯æŒç§’ï¼‰
            timePicker = flatpickr("#timeInput", {
                locale: "zh",
                enableTime: true,
                noCalendar: true,
                dateFormat: "H:i:S",
                time_24hr: true,
                enableSeconds: true,  // å…³é”®ï¼šå¯ç”¨ç§’
                defaultDate: "00:00:00",
                allowInput: false,
                clickOpens: true,
                animate: true,
                onChange: function(selectedDates, timeStr) {
                    convertDate();
                }
            });
        }

        // æ›´æ–°å½“å‰æ—¶é—´
        function updateCurrentTime() {
            const now = Date.now();
            document.getElementById('currentTimestamp').textContent = now;
            document.getElementById('currentDateTime').textContent = DevToolkit.formatTime(now);
        }

        // æ˜¾ç¤ºæ—¶åŒºä¿¡æ¯
        function showTimezoneInfo() {
            const now = new Date();
            const offset = -now.getTimezoneOffset();
            const hours = Math.floor(Math.abs(offset) / 60);
            const minutes = Math.abs(offset) % 60;
            const sign = offset >= 0 ? '+' : '-';
            
            document.getElementById('localTimezone').textContent = 
                Intl.DateTimeFormat().resolvedOptions().timeZone;
            document.getElementById('utcOffset').textContent = 
                `UTC${sign}${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
            
            // ç®€å•åˆ¤æ–­æ˜¯å¦å¯èƒ½å¤„äºå¤ä»¤æ—¶ï¼ˆä»…ä¾›å‚è€ƒï¼‰
            const jan = new Date(now.getFullYear(), 0, 1);
            const jul = new Date(now.getFullYear(), 6, 1);
            const isDST = Math.max(jan.getTimezoneOffset(), jul.getTimezoneOffset()) !== now.getTimezoneOffset();
            document.getElementById('isDST').textContent = isDST ? 'æ˜¯' : 'å¦';

            // æ˜¾ç¤ºæ˜ŸæœŸå‡ 
            const weekdays = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
            document.getElementById('weekday').textContent = weekdays[now.getDay()];
        }

        // ä½¿ç”¨å½“å‰æ—¶é—´æˆ³
        function useCurrentTimestamp() {
            document.getElementById('timestampInput').value = Date.now();
            convertTimestamp();
        }

        // ä½¿ç”¨æŒ‡å®šæ—¶é—´æˆ³
        function useTimestamp(ts) {
            document.getElementById('timestampInput').value = ts;
            convertTimestamp();
        }

        // è½¬æ¢æ—¶é—´æˆ³
        function convertTimestamp() {
            let timestamp = document.getElementById('timestampInput').value.trim();
            
            if (!timestamp) {
                DevToolkit.Toast.warning('è¯·è¾“å…¥æ—¶é—´æˆ³');
                return;
            }

            timestamp = parseInt(timestamp);
            
            if (isNaN(timestamp)) {
                DevToolkit.Toast.error('æ— æ•ˆçš„æ—¶é—´æˆ³æ ¼å¼');
                return;
            }

            // è‡ªåŠ¨è¯†åˆ«ç§’æˆ–æ¯«ç§’
            if (timestamp < 10000000000) {
                timestamp = timestamp * 1000;
            }

            const date = new Date(timestamp);
            
            if (isNaN(date.getTime())) {
                DevToolkit.Toast.error('æ— æ•ˆçš„æ—¶é—´æˆ³');
                return;
            }

            const results = [
                { label: 'Unix æ—¶é—´æˆ³ï¼ˆç§’ï¼‰', value: Math.floor(timestamp / 1000) },
                { label: 'Unix æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰', value: timestamp },
                { label: 'ISO 8601', value: date.toISOString() },
                { label: 'UTC æ—¶é—´', value: date.toUTCString() },
                { label: 'æœ¬åœ°æ—¶é—´', value: DevToolkit.formatTime(date) },
                { label: 'ç›¸å¯¹æ—¶é—´', value: getRelativeTime(date) }
            ];

            displayResults('timestampResults', results);
            DevToolkit.Toast.success('è½¬æ¢å®Œæˆï¼');
        }

        // ä½¿ç”¨ä»Šå¤©æ—¥æœŸå’Œå½“å‰æ—¶é—´
        function useTodayDate() {
            const now = new Date();
            datePicker.setDate(now);
            
            // æ ¼å¼åŒ–å½“å‰æ—¶é—´ä¸º HH:MM:SS
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            const timeStr = `${hours}:${minutes}:${seconds}`;
            
            timePicker.setDate(timeStr);
            convertDate();
        }

        // ä½¿ç”¨æ˜¨å¤©æ—¥æœŸ
        function useYesterdayDate() {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            datePicker.setDate(yesterday);
            timePicker.setDate("00:00:00");
            convertDate();
        }

        // ä½¿ç”¨æ˜å¤©æ—¥æœŸ
        function useTomorrowDate() {
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            datePicker.setDate(tomorrow);
            timePicker.setDate("00:00:00");
            convertDate();
        }

        // é‡ç½®æ—¥æœŸæ—¶é—´
        function resetDateTime() {
            const today = new Date();
            datePicker.setDate(today);
            timePicker.setDate("00:00:00");
            document.getElementById('dateResults').innerHTML = '';
            DevToolkit.Toast.info('å·²é‡ç½®');
        }

        // è½¬æ¢æ—¥æœŸ
        function convertDate() {
            const dateValue = document.getElementById('dateInput').value;
            const timeValue = document.getElementById('timeInput').value;

            if (!dateValue) {
                DevToolkit.Toast.warning('è¯·é€‰æ‹©æ—¥æœŸ');
                return;
            }

            if (!timeValue) {
                DevToolkit.Toast.warning('è¯·é€‰æ‹©æ—¶é—´');
                return;
            }

            const dateTime = `${dateValue}T${timeValue}`;
            const date = new Date(dateTime);

            if (isNaN(date.getTime())) {
                DevToolkit.Toast.error('æ— æ•ˆçš„æ—¥æœŸæ ¼å¼');
                return;
            }

            const timestamp = date.getTime();

            const results = [
                { label: 'Unix æ—¶é—´æˆ³ï¼ˆç§’ï¼‰', value: Math.floor(timestamp / 1000) },
                { label: 'Unix æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰', value: timestamp },
                { label: 'ISO 8601', value: date.toISOString() },
                { label: 'UTC æ—¶é—´', value: date.toUTCString() },
                { label: 'æœ¬åœ°æ—¶é—´', value: DevToolkit.formatTime(date) },
                { label: 'ç›¸å¯¹æ—¶é—´', value: getRelativeTime(date) }
            ];

            displayResults('dateResults', results);
            DevToolkit.Toast.success('è½¬æ¢å®Œæˆï¼');
        }

        // æ˜¾ç¤ºç»“æœ
        function displayResults(containerId, results) {
            const container = document.getElementById(containerId);
            container.innerHTML = results.map(item => `
                <div class="result-item">
                    <div class="result-label">${item.label}</div>
                    <div class="result-value">${item.value}</div>
                    <div class="copy-icon" onclick="DevToolkit.copyToClipboard('${item.value}')" title="å¤åˆ¶">
                        ğŸ“‹
                    </div>
                </div>
            `).join('');
        }

        // è·å–ç›¸å¯¹æ—¶é—´
        function getRelativeTime(date) {
            const now = new Date();
            const diff = now - date;
            const seconds = Math.floor(Math.abs(diff) / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);

            if (diff > 0) {
                if (days > 0) return `${days} å¤©å‰`;
                if (hours > 0) return `${hours} å°æ—¶å‰`;
                if (minutes > 0) return `${minutes} åˆ†é’Ÿå‰`;
                return `${seconds} ç§’å‰`;
            } else {
                if (days > 0) return `${days} å¤©å`;
                if (hours > 0) return `${hours} å°æ—¶å`;
                if (minutes > 0) return `${minutes} åˆ†é’Ÿå`;
                return `${seconds} ç§’å`;
            }
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initDatePickers();
            updateCurrentTime();
            showTimezoneInfo();
            setInterval(updateCurrentTime, 1000);
            
            // åˆå§‹è½¬æ¢
            setTimeout(convertDate, 100);
        });
    </script>
</body>
</html>